/* Get the same gradient depending on tabs side */
@media (-moz-bool-pref: "zen.tabs.vertical.right-side") {
  :root {
    --gradient-start: circle at 95% top;
  }
}
@media not (-moz-bool-pref: "zen.tabs.vertical.right-side") {
  :root {
    --gradient-start: circle at 5% top;
  }
}

/* Control lightness of colors */
@media (prefers-color-scheme: dark) {
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="ReallySubtle"]) {
    --lightness: 7%;
    --accent-color-lightness: 22%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="RatherSubtle"]) {
    --lightness: 9%;
    --accent-color-lightness: 26%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="Normal"]) {
    --lightness: 12%;
    --accent-color-lightness: 30%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="RatherIntense"]) {
    --lightness: 14%;
    --accent-color-lightness: 34%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="ReallyIntense"]) {
    --lightness: 16%;
    --accent-color-lightness: 38%;
  }
} 
@media (prefers-color-scheme: light) {
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="ReallySubtle"]) {
    --lightness: 88%;
    --accent-color-lightness: 70%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="RatherSubtle"]) {
    --lightness: 84%;
    --accent-color-lightness: 67%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="Normal"]) {
    --lightness: 80%;
    --accent-color-lightness: 63%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="RatherIntense"]) {
    --lightness: 76%;
    --accent-color-lightness: 58%;
  }
  :root:has(#theme-SuperGradient[theme-supergradient-intensity="ReallyIntense"]) {
    --lightness: 72%;
    --accent-color-lightness: 50%;
  }
}

/* Control saturation of colors */
@media (-moz-bool-pref: "uc.supergradient.desaturate") {
  :root {
    --saturation: 55%;
  }
}
@media not (-moz-bool-pref: "uc.supergradient.desaturate") {
  :root {
    --saturation: 75%;
  }
}

/* SuperGradient Presets */

/* 1. Top-left; 2. Bottom-left; 3. Top-right'ish 4. Bottom-right*/

:root:has(#theme-SuperGradient[theme-supergradient-preset="NorthernHorizen"]) {
  --gradient-color1: hsl(220, var(--saturation), var(--lightness));
  --gradient-color2: hsl(160, var(--saturation), var(--lightness));
  --gradient-color3: hsl(200, var(--saturation), var(--lightness));
  --gradient-color4: hsl(180, var(--saturation), var(--lightness));
  --switched-color1: hsl(160, var(--saturation), var(--lightness));
  --switched-color2: hsl(220, var(--saturation), var(--lightness));
  --switched-color3: hsl(180, var(--saturation), var(--lightness));
  --switched-color4: hsl(200, var(--saturation), var(--lightness));
  --custom-accent-color: hsla(205, 50%, var(--accent-color-lightness), 0.7);
  --switched-accent-color: hsla(170, 50%, var(--accent-color-lightness), 0.7);
}

:root:has(#theme-SuperGradient[theme-supergradient-preset="ScarletDusk"])  {
  --gradient-color1: hsl(340, var(--saturation), var(--lightness));
  --gradient-color2: hsl(40, var(--saturation), var(--lightness));
  --gradient-color3: hsl(30, var(--saturation), var(--lightness));
  --gradient-color4: hsl(340, var(--saturation), var(--lightness));
  --switched-color1: hsl(40, var(--saturation), var(--lightness));
  --switched-color2: hsl(340, var(--saturation), var(--lightness));
  --switched-color3: hsl(340, var(--saturation), var(--lightness));
  --switched-color4: hsl(30, var(--saturation), var(--lightness));
  --custom-accent-color: hsla(350, 50%, var(--accent-color-lightness), 0.6);
  --switched-accent-color: hsla(40, 50%, var(--accent-color-lightness), 0.6);
}

:root:has(#theme-SuperGradient[theme-supergradient-preset="AmethystClaret"])  {
  --gradient-color1: hsl(270, var(--saturation), var(--lightness));
  --gradient-color2: hsl(0, var(--saturation), var(--lightness));
  --gradient-color3: hsl(320, var(--saturation), var(--lightness));
  --gradient-color4: hsl(20, var(--saturation), var(--lightness));
  --switched-color1: hsl(0, var(--saturation), var(--lightness));
  --switched-color2: hsl(270, var(--saturation), var(--lightness));
  --switched-color3: hsl(20, var(--saturation), var(--lightness));
  --switched-color4: hsl(320, var(--saturation), var(--lightness));
  --custom-accent-color: hsla(280, 50%, var(--accent-color-lightness), 0.5);
  --switched-accent-color: hsla(350, 50%, var(--accent-color-lightness), 0.5);
}

:root:has(#theme-SuperGradient[theme-supergradient-preset="OliveSunset"])  {
  --gradient-color1: hsl(20, var(--saturation), var(--lightness));
  --gradient-color2: hsl(65, var(--saturation), var(--lightness));
  --gradient-color3: hsl(50, var(--saturation), var(--lightness));
  --gradient-color4: hsl(160, var(--saturation), var(--lightness));
  --switched-color1: hsl(65, var(--saturation), var(--lightness));
  --switched-color2: hsl(20, var(--saturation), var(--lightness));
  --switched-color3: hsl(160, var(--saturation), var(--lightness));
  --switched-color4: hsl(50, var(--saturation), var(--lightness));
  --custom-accent-color: hsla(40, 50%, var(--accent-color-lightness), 0.5);
  --switched-accent-color: hsla(60, 50%, var(--accent-color-lightness), 0.5);
}

:root:has(#theme-SuperGradient[theme-supergradient-preset="MidnightMajesty"])  {
  --gradient-color1: hsl(50, var(--saturation), var(--lightness));
  --gradient-color2: hsl(300, var(--saturation), var(--lightness));
  --gradient-color3: hsl(60, var(--saturation), var(--lightness));
  --gradient-color4: hsl(10, var(--saturation), var(--lightness));
  --switched-color1: hsl(300, var(--saturation), var(--lightness));
  --switched-color2: hsl(50, var(--saturation), var(--lightness));
  --switched-color3: hsl(10, var(--saturation), var(--lightness));
  --switched-color4: hsl(60, var(--saturation), var(--lightness));
  --custom-accent-color: hsla(50, 50%, var(--accent-color-lightness), 0.5);
  --switched-accent-color: hsla(310, 50%, var(--accent-color-lightness), 0.4);
}

/* Switch the colors in the gradient (when toggled) */
@media (-moz-bool-pref: "uc.supergradient.switch-colors") {
  :root {
    --gradient-color1: var(--switched-color1) !important;
    --gradient-color2: var(--switched-color2) !important;
    --gradient-color3: var(--switched-color3) !important;
    --gradient-color4: var(--switched-color4) !important; 
    --custom-accent-color: var(--switched-accent-color) !important;
  }
}

/* Applies the color gradient based on the set user preferences */
:root {
  --zen-colors-tertiary: radial-gradient(var(--gradient-start), var(--gradient-color1), var(--gradient-color2), var(--gradient-color3), var(--gradient-color4)) !important;
}

/* Use custom accent colors adjusted to the gradient (unless toggled, which uses zen's accent color) */
@media not (-moz-bool-pref: "uc.supergradient.use-accent-color") {
  :root {
    --toolbarbutton-hover-background: var(--custom-accent-color) !important;
  }
  /* background color of pinned tabs in a normal state (not hovered/selected) */
  .tabbrowser-tab[pinned] .tab-stack .tab-background {
    background-color: color-mix(in srgb, var(--custom-accent-color) 35%, transparent 75%) !important;
  }
  /* background color when hovering */
  .tabbrowser-tab:hover .tab-stack .tab-background{
    background-color: color-mix(in srgb, var(--custom-accent-color) 50%, transparent 75%) !important;
  }
  /* background color when selected */
  .tabbrowser-tab[selected="true"] .tab-stack .tab-background,
  .tabbrowser-tab[multiselected="true"] .tab-stack .tab-background {
    background-color: var(--custom-accent-color) !important;
  }
  /* background color when hovering and selected */
  .tabbrowser-tab[selected="true"]:hover .tab-stack .tab-background,
  .tabbrowser-tab[multiselected="true"]:hover .tab-stack .tab-background{
    background-color: color-mix(in srgb, var(--custom-accent-color) 90%, transparent) !important;
  }
}

/* Make gradient work when "Expand on hover" is enabled */
@media (-moz-bool-pref: "zen.view.sidebar-expanded") and (-moz-bool-pref: "zen.view.sidebar-expanded.on-hover") {
  #navigator-toolbox:is(
    #navigator-toolbox[zen-user-hover="true"]:hover,
    #navigator-toolbox[zen-user-hover="true"]:focus-within,
    #mainPopupSet[zen-user-hover="true"]:has(> #appMenu-popup:hover) ~ toolbox,
    #navigator-toolbox[zen-user-hover="true"]:has(*[open="true"]:not(tab):not(#zen-sidepanel-button)), 
    :not([zen-user-hover="true"])) {
      #TabsToolbar {
        background: radial-gradient(var(--gradient-start), var(--gradient-color1), var(--gradient-color2), var(--gradient-color3), var(--gradient-color4)) !important;
      }
  }
}

/* This fixes the corners of the browser content not being clean*/
:root:not([inDOMFullscreen='true']):not([chromehidden~='location']):not([chromehidden~='toolbar']) {
  & #tabbrowser-tabbox #tabbrowser-tabpanels .browserSidebarContainer {
    overflow: hidden;
  }
}